<div class="header-container">
    <p><%= cl_image_tag @user.photo.key,  class: "avatar-large" %></p>
    <h2> <%= @user.first_name.split(" ").first.capitalize %> <%= @user.last_name.split(" ").first.capitalize %>
    <p> <i class="fab fa-facebook-square fa-xs"></i> <i class="fab fa-instagram-square fa-xs"></i> <i class="fab fa-twitter-square fa-xs"></i> <i class="fas fa-envelope-square fa-xs"></i> </p>
</div>

<div class="users-show-container">
    <%= week_calendar(number_of_weeks: 2) do |date| %>
      <%= date.day %>
       <% @user.courses.each do |course| %>
          <% course.occurences.each do |occurence| %>
            <% if occurence.date.to_datetime.to_date == date %>
              <div class='calendar-card'>
                <%= link_to occurence.course.name, course_occurence_path(occurence.course, occurence) %>
                <br><strong><%= occurence.dateparse.strftime("%H:%M") %></strong>
                <br>
                    <% if user_signed_in? %>
                        <% if current_user == @user %>
                                    <%= link_to edit_course_occurence_path(occurence.course, occurence) do %><i class="far fa-edit"></i> <% end %>
                                    <%= link_to course_occurence_path(course, occurence), method: :delete, data: { confirm: "Are you sure you would like to delete?" } do %> <i class="far fa-trash-alt"></i> <% end %>
                        <% elsif occurence.capacity == occurence.users.count %>
                            Full
                        <% elsif current_user.bookings.where(occurence_id: occurence.id).first %>
                            <small><strong>Already Booked</strong></small>
                            <%= link_to 'Cancel?', course_occurence_booking_path(occurence.course.id, occurence.id, current_user.bookings.where(occurence_id: occurence.id).first), method: :delete, data: { confirm: "Are you sure?" }, class: 'btn btn-clear' %>
                        <% else %>
                                <small><%= link_to "Book", course_occurence_bookings_path(occurence.course.id, occurence.id), method: :post, class: "btn-primary-small" %></small>
                        <% end %>
                    <% else %>
                        <%= link_to "Login", new_user_session_path, class: 'btn btn-primary' %>
                    <% end %>
              </div>
            <% end %>
          <% end %>
        <% end %>
    <% end %>
</div>

<div class="header-container">
    <%= @user.bio %>
</div>
